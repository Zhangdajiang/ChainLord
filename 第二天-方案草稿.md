# 第二天方案草稿（多 Agent + MCP 搜索）

## 目标
- 将单 Agent 改为三 Agent 顺序工作流：
  - 风险官 → 机会官 → 和事佬总结
- 接入 SpoonOS 的搜索工具（MCP），让第一个 Agent 获取实时信息并传递
- 保持现有单 Agent 聊天作为 fallback

---

## 设计思路
1. **输入**：用户输入一个“市场热点问题”
2. **Agent 1（风险官）**：
   - 调用 MCP 搜索工具，抓取最新信息
   - 总结风险点
3. **Agent 2（机会官）**：
   - 基于 Agent1 的搜索结果与风险总结，提出机会
4. **Agent 3（和事佬）**：
   - 结合前两位观点，给出折中建议与结论
5. **输出**：三段式结果依次显示

---

## 结构草稿（伪代码）
```
user_input = "今天ETH为什么涨？"

search_result = risk_agent.search_mcp(user_input)
risk_reply = risk_agent.reply(user_input, search_result)

chance_reply = chance_agent.reply(user_input, search_result, risk_reply)

final_reply = mediator_agent.reply(user_input, search_result, risk_reply, chance_reply)
```

---

## MCP 搜索接入草案
### 1. MCP Server（Google Search）
- 使用 SpoonOS MCP 工具
- 环境变量配置（示例）：
  ```
  TAVILY_API_KEY=...
  ```

### 2. Agent 与 MCP Tool 绑定
- SpoonOS 支持在 Agent 中注册 MCP 工具
- 第一个 Agent 负责调用搜索工具

---

## UI 交互草案
- 侧边栏新增“模式选择”
  - 单 Agent（默认）
  - 三 Agent（多谋士）
- 主界面展示：
  - 风险官：红色标签
  - 机会官：绿色标签
  - 和事佬：蓝色标签

---

## 明天的具体任务清单
1. 读取 SpoonOS MCP 官方示例（确认调用方式）
2. 实现 MCP 搜索调用函数
3. 增加三个 Agent 的顺序逻辑
4. UI 上按顺序展示三段回复
5. 保留单 Agent 模式作为 fallback

---

## 风险与兜底
- MCP 搜索失败 → fallback 为单 Agent
- API 限速 → 搜索结果缓存 5~10 分钟
- 规则冲突 → 仅让和事佬输出最终建议

