# 复盘记录（2026-01-29）

## 今日目标
- 搭建 Streamlit + SpoonOS SDK 环境
- 实现钱包连接按钮并显示地址
- 实现聊天输入框，AI 按侧边栏人设回复
- 成功标准：网页显示钱包地址 + AI 按人设回复

## 已完成内容
- Streamlit 应用已可正常启动
- 侧边栏人设输入与保存完成
- 聊天输入与消息历史显示完成
- 钱包连接按钮可用（当前为演示地址）
- DeepSeek 可正常回复（已调通）

## 关键改动与结论
- **只保留 DeepSeek**：当前仅使用 `deepseek` Provider，暂时移除 OpenAI/Claude
- **异步调用修正**：使用 `anyio.run()` 运行 `ChatBot.ask`
- **DeepSeek max_tokens 修正**：
  - SDK 默认 `max_tokens=65536` 会触发 400
  - 在代码中强制设置 `DEEPSEEK_MAX_TOKENS=4096`
  - `ChatBot` 也显式传入 `max_tokens=4096`

## 当前主要文件
- `app.py`：主应用入口
- `requirements.txt`：依赖列表
- `.env`：仅需 `DEEPSEEK_API_KEY`

## 当前运行命令
```
python -m streamlit run "C:\Users\Zhangdajiang\Desktop\my_ai_lab\app.py"
```

## 环境说明
- Python 3.14
- Streamlit 1.53.1
- spoon-ai-sdk 0.3.6
- 仅使用 DeepSeek

## 还未完成（后续）
- 钱包连接仍为模拟地址（需接入真实 SpoonOS 钱包登录）
- OpenAI / Claude 暂未接回（待 DeepSeek 稳定后再接）

## 明天可继续的任务
- 接入 SpoonOS 钱包真实登录接口
- 增加配置项，让模型选择可切换
- 优化错误提示与 UI 体验

## 常见错误与处理
- `streamlit` 命令找不到：用 `python -m streamlit`
- `unknown async library`：改用 `anyio.run`
- `Invalid max_tokens`：设置 `DEEPSEEK_MAX_TOKENS=4096`

